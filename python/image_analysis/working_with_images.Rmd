---
title: '<font size="5">Image Analysis in Python:</font><br>Working With Images'
output:
    html_document:
        theme: paper
        highlight: textmate
        number_sections: true
        toc: true
        includes:
            before_body: ../../google_analytics.html
---

<font size="3">

[⇦ Back](../../python.html)

<!-- Created: 2023-12-25 -->
<!-- Based off code from: 2023-07-28 -->

Python Packages
===============
The code on this page uses the Matplotlib, Pillow and NumPy packages. These can be installed from the terminal with:

```bash
# Replace "python3.12" with the version of Python you are using

# Matplotlib is for creating static, animated and interactive visualizations
python3.12 -m pip install matplotlib
# Pillow is a fork of the Python Imaging Library (PIL) for image processing
python3.12 -m pip install pillow
# NumPy is the fundamental package for scientific computing with Python
python3.12 -m pip install numpy
```

Once finished, import these packages into your Python script as follows:

```{python}
from matplotlib import pyplot as plt
from PIL import Image
import numpy as np
```

Import an Image
===============
Every image is made up of *pixels* and each pixel has a *colour*. Each colour is represented by three numbers - known as its **RGB** value - which represent the amount of **r**ed, **g**reen** and **b**lue in that colour, respectively. An RGB value's three numbers range from 0 (least) to 1 (most):

- The colour "(1, 0, 0)" is pure red
- The colour "(0, 1, 0)" is pure green
- The colour "(0, 0, 1)" is pure blue
- The colour "(0, 0, 0)" is pure black (ie no colour)
- The colour "(1, 1, 1)" is pure white (ie all the colours)
- Any other combination of three numbers between 0 and 1 can be interpreted as a shade of colour: "0.1, 0.6, 0.8" is a greenish-blue, for example.

Note that, often, these three numbers will be represented as integers between 0 and 255 (ie "(255, 0, 0)" will be red, etc). This is just a different method of storing the same information.

Import Using Matplotlib
-----------------------
Let's take the following 3-pixel image as an example:

![](rgb_large.png)

Let's see what happens when we import it into Python using `imread()` (**im**age **read**) from Matplotlib:

```{python}
# Read an image as a NumPy array
img = plt.imread('rgb.png')
# Print the pixels' values
print(img)
```

The first row of the above array is `[1. 0. 0.]` which corresponds to the fact that the first pixel is red. The second row is `[0. 1. 0.]` because the second pixel is green, and the third row is `[0. 0. 1.]` because the third pixel is blue. In fact, we actually have a **3-dimensional** array of numbers: the first dimension represents the *rows* of pixels, the second dimension is the *columns* and the third dimension is the *RGB values*. If we look up just the first row, first column and all the RGB values we get the following:

```{python}
# Print the first pixel's values
print(img[0, 0, :])
```

This tells us that the pixel in the first row and first column has the RGB value `[1. 0. 0.]` - ie it is red.

Import Using Pillow
-------------------
We can also read an image using the `open()` function from Pillow (previously known as PIL - the **P**ython **I**maging **L**ibrary - and it is still imported under the name `PIL`):

```{python}
# Open an image as a Pillow image
img = Image.open('rgb.png')
# Print the object
print(img)
```

This clearly hasn't given us an array but rather a PNG image object. Depending on what you are trying to do a PNG object might be easier to work with than an array.

Converting Between Arrays and PNG Objects
-----------------------------------------
A NumPy array can be converted into a PNG object using the `fromarray()` function from Pillow but be aware that the values need to be integers running from 0 to 255 as opposed to decimals between 0 and 1:

```{python}
# Read an image as a NumPy array
img = plt.imread('rgb.png')
# Scale the float32 array to the 0-255 range and convert to uint8
img = (img * 255).astype(np.uint8)
# Convert the NumPy array into a Pillow image
img = Image.fromarray(img)
# Print the object
print(img)
```

A PNG object can be converted into a NumPy array directly:

```{python}
# Open an image as a Pillow image
img = Image.open('rgb.png')
# Convert the Pillow image into a NumPy array
img = np.array(img)
# Print the pixels' values
print(img)
```

Note that the values in the array are on the 0-255 scale.


[⇦ Back](../../python.html)

</font>
